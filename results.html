<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <title>Survey Dashboard</title>
</head>
<body class="bg-gray-100 p-6">
<div class="container mx-auto">
    <h1 class="text-3xl font-bold mb-4">Survey Dashboard</h1>

    <div id="dashboard" class="grid grid-cols-1 md:grid-cols-1 gap-4">
        <!-- Section headers and charts will be dynamically injected here -->
    </div>
</div>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script>
    const BASEROW_API_TOKEN = 'RrrbVJVAMyvpPwuOFL5s78uyq6avzjn9';
    const BASEROW_DATABASE_ID = '176815';
    const BASEROW_TABLE_ID = '434056';

    const surveyQuestions = [
        {
            section: "Productivity Changes",
            questions: [
                {
                    identifier: "speed",
                    statement: "The use of AI tools has increased the speed at which I complete tasks.",
                    type: "likert",
                    options: ["Strongly Disagree", "Disagree", "Neutral", "Agree", "Strongly Agree"],
                },
                {
                    identifier: "volume",
                    statement: "The use of AI tools has changed the volume of work I can complete.",
                    type: "likert",
                    options: ["Strongly Disagree", "Disagree", "Neutral", "Agree", "Strongly Agree"],
                },
                {
                    identifier: "deadlines",
                    statement: "The use of AI has impacted my ability to meet deadlines.",
                    type: "likert",
                    options: ["Significantly more difficult", "Slightly more difficult", "No change", "Slightly easier", "Significantly easier"],
                },
            ],
        },
        {
            section: "Skill Changes",
            questions: [
                {
                    identifier: "skillchanges",
                    statement: "The introduction of AI has led to changes in the skills I need to perform my job.",
                    type: "likert",
                    options: ["Strongly Disagree", "Disagree", "Neutral", "Agree", "Strongly Agree"],
                },
               {
                identifier: "lessimportant",
                statement: "The skills I previously needed are now less important.",
                 type: "openText",
            },
            {
                identifier: "moreimportant",
                statement: "New skills have become more important due to AI introduction.",
                 type: "openText",
            },
                {
                    identifier: "improvedskills",
                    statement: "The use of AI has improved my skills by enabling me to do more complex work.",
                    type: "likert",
                    options: ["Strongly Disagree", "Disagree", "Neutral", "Agree", "Strongly Agree"],
                },
            ],
        },
        {
            section: "Job Role Changes",
            questions: [
                {
                    identifier: "scope",
                    statement: "The introduction of AI has changed the scope or responsibilities of my job.",
                    type: "likert",
                    options: ["Strongly Disagree", "Disagree", "Neutral", "Agree", "Strongly Agree"],
                },
                {
                    identifier: "changedresponsibilities",
                    statement: "The scope and responsibilities of my job have changed due to the introduction of AI.",
                     type: "openText",
                },
                {
                    identifier: "replace",
                    statement: "AI has the potential to replace some of the tasks I currently perform.",
                    type: "likert",
                    options: ["Strongly Disagree", "Disagree", "Neutral", "Agree", "Strongly Agree"],
                },
                {
                    identifier: "augment",
                    statement: "AI has the potential to augment my work and allow me to focus on higher level tasks.",
                    type: "likert",
                    options: ["Strongly Disagree", "Disagree", "Neutral", "Agree", "Strongly Agree"],
                }
            ],
        },
        {
            section: "Accountability and Trust",
            questions: [
                {
                    identifier: "responsible",
                    statement: "I feel responsible for the output generated by AI tools I use.",
                    type: "likert",
                    options: ["Strongly Disagree", "Disagree", "Neutral", "Agree", "Strongly Agree"],
                },
                {
                    identifier: "understanding",
                    statement: "I have sufficient understanding of how the AI tools I use make decisions.",
                    type: "likert",
                    options: ["Strongly Disagree", "Disagree", "Neutral", "Agree", "Strongly Agree"],
                },
                {
                    identifier: "trust",
                    statement: "I trust that my colleagues are using AI responsibly.",
                    type: "likert",
                    options: ["Not at all", "A little", "Moderately", "A lot", "Completely"],
                },
                {
                    identifier: "guidance",
                    statement: "Management provides sufficient guidance on the use of AI.",
                    type: "likert",
                    options: ["Strongly Disagree", "Disagree", "Neutral", "Agree", "Strongly Agree"],
                },
                {
                    identifier: "training",
                    statement: "My company provides training to ensure the responsible use of AI in the workplace.",
                    type: "likert",
                    options: ["Strongly Disagree", "Disagree", "Neutral", "Agree", "Strongly Agree"],
                },
            ],
        },
        {
            section: "Job Satisfaction and Empowerment",
            questions: [
                {
                    identifier: "interesting",
                    statement: "The introduction of AI has made my job more or less interesting.",
                    type: "likert",
                    options: ["Significantly less interesting", "Slightly less interesting", "No change", "Slightly more interesting", "Significantly more interesting"],
                },
                {
                    identifier: "jobenrichment",
                    statement: "AI is positioned as a tool for job enrichment rather than just for productivity gain.",
                    type: "likert",
                    options: ["Strongly Disagree", "Disagree", "Neutral", "Agree", "Strongly Agree"],
                },
                {
                    identifier: "empowered",
                    statement: "I feel empowered to experiment with AI to improve my work.",
                    type: "likert",
                    options: ["Strongly Disagree", "Disagree", "Neutral", "Agree", "Strongly Agree"],
                },
            ],
        },
        {
            section: "Training and Support",
            questions: [
                {
                    identifier: "trainingandsupport",
                    statement: "I am provided with adequate training and support to use AI effectively.",
                    type: "likert",
                    options: ["Not at all", "A little", "Moderately", "A lot", "Completely"],
                },
                {
                    identifier: "taskspecifictools",
                    statement: "I have access to task-specific AI tools that are relevant to my daily work.",
                    type: "likert",
                    options: ["Strongly Disagree", "Disagree", "Neutral", "Agree", "Strongly Agree"],
                },
            ],
        },
        {
            section: "Overall Impact",
            questions: [
                {
                    identifier: "overallimpact",
                    statement: "Overall, AI has impacted my work experience.",
                    type: "likert",
                    options: ["Very Negative", "Negative", "Neutral", "Positive", "Very Positive"],
                },
                 {
                    identifier: "mainbenefit",
                     statement: "What is the main benefit you have experienced since your department started using AI?",
                      type: "openText",
                },
                {
                    identifier: "mainchallenge",
                     statement: "What is the main challenge you have experienced since your department started using AI?",
                      type: "openText",
                }
            ],
        },
    ];

    // Load data from Baserow
    async function loadBaserowData() {
        const url = `https://api.baserow.io/api/database/rows/table/${BASEROW_TABLE_ID}/?user_field_names=true`;
        const response = await axios.get(url, {
            headers: {
                Authorization: `Token ${BASEROW_API_TOKEN}`
            }
        });
        return response.data.results;
    }

    // Render a chart for a single question
    function renderChart(section, question, questionText, options, data, sectionContainer) {
        const counts = Array(options.length).fill(0);

        data.forEach(row => {
            const value = parseInt(row[question]);
            if (value >= 1 && value <= options.length) {
                counts[value - 1]++;
            }
        });

        const chartContainer = document.createElement("div");
        chartContainer.className = "p-4 bg-white shadow rounded";

        chartContainer.innerHTML = `
            <h2 class="text-xl font-semibold mb-2">${questionText}</h2>
            <canvas id="chart-${section}-${question}"></canvas>
        `;

        sectionContainer.appendChild(chartContainer);

        new Chart(document.getElementById(`chart-${section}-${question}`), {
            type: 'bar',
            data: {
                labels: options,
                datasets: [{
                    label: 'Responses',
                    data: counts,
                    backgroundColor: 'rgba(75, 192, 192, 0.6)',
                }]
            },
            options: {
                scales: {
                    y: { beginAtZero: true },
                },
            },
        });
    }

    // Initialize dashboard
    async function initDashboard() {
        const data = await loadBaserowData();
        const dashboard = document.getElementById("dashboard");

        surveyQuestions.forEach(({ section, questions }) => {
            const sectionContainer = document.createElement("div");
            sectionContainer.className = "mb-8";
            sectionContainer.innerHTML = `<h2 class="text-2xl font-bold mb-4">${section}</h2>`;
            dashboard.appendChild(sectionContainer);

            questions.forEach(question => {
                if (question.type === "likert") {
                    renderChart(section, question.identifier, question.statement, question.options, data, sectionContainer);
                }
            });
        });
    }

    initDashboard();
</script>
</body>
</html>